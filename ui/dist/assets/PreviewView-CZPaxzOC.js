import{an as S,X as N,D as f,u as _,ao as T,H as m,x as p,am as P,c as g,ae as v,ac as C,af as l,M as E,ai as k,o as I}from"./index-Bf8MNAMK.js";import{a as d,e as r}from"./screens-DALX6Lmd.js";const U=S("screenPreview",()=>{const e=d(),i=N();function s(){var o,c,a;e.socket&&e.credentials&&(console.log("LISTENING SCREEN PREVIEW EVENTS"),e.socket.on(r.SCREEN_UNIQUE,n=>{console.log("UNIQUE",n),n.id===e.credentials.screenId&&(i.value=n)}),e.socket.on(r.SCREEN_UPDATE_STATUS,n=>{console.log("update status"),n.id===e.credentials.screenId&&(i.value=n)}),(o=e.socket)==null||o.on(r.SCREEN_CONTENT_PLAY,n=>{console.log("PLAYING",n),n===e.credentials.screenId&&t("playing")}),(c=e.socket)==null||c.on(r.SCREEN_CONTENT_PAUSE,n=>{console.log("PAUSED",n),n===e.credentials.screenId&&t("paused")}),(a=e.socket)==null||a.on(r.SCREEN_CONTENT_STOP,n=>{console.log("STOPPED",n),n===e.credentials.screenId&&t("stopped")}))}function t(o="active"){var c;(c=e.socket)==null||c.emit(r.SCREEN_UPDATE_STATUS,{id:e.credentials.screenId,status:o})}function u(o){}return{screenPreview:i,listenEvents:s,getScreen:u,setScreenStatus:t}}),w=f({__name:"PreviewView",setup(e){const i=T(),s=d(),t=U(),u=_(()=>({screenId:Number(i.params.screenId),rol:"admin"}));return m(()=>{console.log("disconnecting socket"),s.connect(u.value)}),p(()=>s.isConnected,o=>{o&&(t.listenEvents(),t.setScreenStatus("active"))}),P(()=>{s.socket&&s.disconnect()}),(o,c)=>{var a;return I(),g(k,null,[v("h1",null,l(),1),C(" "+l(E(s).isConnected)+" "+l(JSON.stringify(E(s).credentials))+" "+l(JSON.stringify((a=E(t).screenPreview)==null?void 0:a.status)),1)],64)}}});export{w as default};

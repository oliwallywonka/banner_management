import{aV as E,_ as S,D as f,u as N,aW as _,H as T,x as p,T as P,c as m,$ as g,aw as v,ax as i,M as l,a5 as k,o as C}from"./index-BAlmRFvf.js";import{a as d,e as r}from"./groups-eE1jstoI.js";const w=E("screenPreview",()=>{const t=d(),a=S();function n(){var c,s,u;t.socket&&t.credentials&&(console.log("LISTENING SCREEN PREVIEW EVENTS"),t.socket.on(r.SCREEN_UPDATE_STATUS,e=>{console.log("update status"),e.code===t.credentials.code&&(a.value=e)}),(c=t.socket)==null||c.on(r.SCREEN_CONTENT_PLAY,e=>{console.log("PLAYING",e),e.includes(t.credentials.code)&&o("playing")}),(s=t.socket)==null||s.on(r.SCREEN_CONTENT_PAUSE,e=>{console.log("PAUSED",e),e.includes(t.credentials.code)&&o("paused")}),(u=t.socket)==null||u.on(r.SCREEN_CONTENT_STOP,e=>{console.log("STOPPED",e),e.includes(t.credentials.code)&&o("stopped")}))}function o(c="active"){var s;(s=t.socket)==null||s.emit(r.SCREEN_UPDATE_STATUS,{code:t.credentials.code,status:c})}return{screenPreview:a,listenEvents:n,setScreenStatus:o}}),O=f({__name:"PreviewView",setup(t){const a=_(),n=d(),o=w(),c=N(()=>({code:a.params.code}));return T(()=>{console.log("disconnecting socket"),n.connect(c.value)}),p(()=>n.isConnected,s=>{s&&(o.listenEvents(),o.setScreenStatus("active"))}),P(()=>{n.socket&&n.disconnect()}),(s,u)=>{var e;return C(),m(k,null,[g("h1",null,i(),1),v(" "+i(l(n).isConnected)+" "+i(JSON.stringify(l(n).credentials))+" "+i(JSON.stringify((e=l(o).screenPreview)==null?void 0:e.status)),1)],64)}}});export{O as default};
